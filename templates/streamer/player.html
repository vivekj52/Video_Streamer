<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'streamer/player.css' %}"/>
</head>

<body>

<header>
Â  <h1 align="center">VIDEO STREAMER</h1>
    {% block content %}
    {% if user.is_authenticated %}
      Hi {{ user.username }}!<br><br>
        {{ user.email }}
      <p><a href="{% url 'logout' %}">Log Out</a></p>
    {% else %}
      <p>You are not logged in</p>
      <a href="{% url 'login' %}">Log In</a>
    {% endif %}
    {% endblock %}
</header>

        <div class="slider_wrapper">
        <iframe class="slider_video" id="video" src= "video?path=" frameborder="5"></iframe>
        <!-- start slider menu -->
            <div class="slider_menu_container">
                <div class="slider_menu" id="myItemList">
                 <ul id="video_id"></ul>
                </div>
            </div>
        </div>
<script>

    function httpGet(theUrl)
    {
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
        xmlHttp.send( null );
        return xmlHttp.responseText;
    }

    let movies = httpGet('movies');
    movies = JSON.parse(movies);
    console.log(movies);
    let ul = document.createElement('ul');

    document.getElementById('myItemList').appendChild(ul);

    movies.forEach(function (movie) {
        let li = document.createElement('li');
        li.onclick = function(){
            let name = li.innerText;
            let path = "";
            for (let i = 0; i < movies.length; i++){
                if (movies[i].name == name)
                    path = movies[i].path;
            }
            let vid = document.getElementsByTagName('iframe')[0];
            console.log(path);
            vid.src = "video?path="+path;
        };
        ul.appendChild(li);

    li.innerHTML += movie.name;
    });

</script>
</body>
</html>